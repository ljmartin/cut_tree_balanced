---
title: "cutTreeBalanced - Balanced cuts for dendrograms"

output: pdf_document

citation-style: nature.csl

numbersections: true

bibliography: references.bib


author:
 - Lewis J. Martin¹ (ljmartin@hey.com)
 - Vicente Reyes-Puerta² (vicente ur email if u want) 
...

¹ University of Sydney, NSW, Australia

² Vicente's affiliation if desired

# Abstract

Hierarchical clustering techniques are common in a wide range of fields. The output of these techniques are dendrograms, which are trees that define the linkages between input data leading to clusters. Generating clusters requires some method of cutting the dendrogram to separate groups of points from each other. Many existing cutting techniques, such as a straight cut along a constant height, lead to clusters with highly imbalanced sizes. In certain cases, such as with high-dimensional data, these clusters do not accurately represent the underlying structure of the data. This paper presents and demonstrates balancedCut for Python - a fast and simple method of cutting dendrograms that results in balanced cluster sizes.

# Introduction

Hierarchical (alternatively agglomerative) clustering techniques are common in a wide range of fields such as astronomy, biology, chemistry, economics, ecology and bioinformatics, where they are used to group objects based on their similarity in some metric space. Ideally, these groupings organize the data by abstracting the underlying structure into the cluster labels, leading to new insight @johnson1967hierarchical. In a typical setting, a pairwise distance matrix is used to iteratively join individual objects, or groups of objects, together into larger and larger clusters @bramer2007principles. This results in a dendrogam, which fully describes the linkages between the initial state (where each object is in a single-member cluster) to the end state (where all objects are grouped into one cluster). An example of a dendrogram is shown in Figure  @fig:straightCut.

![A dendrogram generated by single-linkage clustering, showing a straight cut at height XYZ. Straight cuts at any height generate clusters with imbalanced sizes (`can we add a histogram of cluster sizes at multiple heights? LJM)`](../dendrogram_1_standard_cut.png){#fig:straightCut}

Joining nodes in a dendrogram requires a rubric to define the shortest similarity. For example, single-linkage clustering joins clusters based on the shortest distance between any member. Alternatively, complete linkage defines the shortest similarity as the smallest maximum distance between two clusters. A third method, Ward linkage, chooses clusters based on the minimum increase in within-cluster variance [`ref`]. All of these methods result in dendrograms of the same form. To generate cluster labels, the dendrogram is 'cut' at a certain point, such that all cluster joins after that point are ignored (see @fig:straightCut). A common type of cut, which is also conceptually simple, is demonstrated in @straightCut, whereby all linkages beyond a user-defined similarity are ignored. This may also be known as a constant height cut. 

Constant-height cuts commonly lead to clusters with imbalanced sizes. 

- hdbscan: @mcinnes2017hdbscan, dynamicTreeCut @langfelder2008defining

- High-dimensional data have reduced contrast @beyer1999nearest, and often high 'hubness' @radovanovic2010hubs, as a result of curse of dimensionality. In these cases, similarity by usual distance metrics is not well defined. Single-linkage, Ward linkage, or other linkages may result in dendrograms that are impossible to cut while preserving underlying structure. In these cases, variable cutting distance is required.

- Example of hubness causing bad hierarchical clustering results: @maccuish2001ties
 
(a reference to the abstract: [Abstract](#abstract)). 

# Algorithm and Results

[algorithm explanation]


![The same dendrogram as in @fig:straightCut, but demonstrating a balanced cut of size XYZ](../dendrogram_2_balanced_cut.png){#fig:balancedCut}




# References